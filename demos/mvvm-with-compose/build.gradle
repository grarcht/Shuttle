plugins {
    id 'com.android.application'
    id 'kotlin-android'
    id 'org.jetbrains.dokka'
    id 'dagger.hilt.android.plugin'
    id 'com.google.devtools.ksp'
    id 'de.mannodermaus.android-junit5'
    id 'org.jetbrains.kotlin.android'
}

apply from: '../../detekt/detekt.gradle'

dokkaHtml {
    outputDirectory.set(file("documentation/kotlin"))
}

android {
    compileSdk versions.android.compileSdk

    defaultConfig {
        applicationId 'com.grarcht.shuttle.mvvm_with_compose'
        minSdk versions.android.minSdk
        targetSdk versions.android.targetSdk
        versionCode 1
        versionName "1.0"
        testInstrumentationRunner "androidx.test.runner.AndroidJUnitRunner"
        testInstrumentationRunnerArgument("runnerBuilder", "de.mannodermaus.junit5.AndroidJUnit5Builder")
//        multiDexEnabled true
    }

    configurations.configureEach {
        resolutionStrategy.eachDependency { details ->
            def module = details.requested.module.toString()
            if (module.contains("lifecycle-common") || module.contains("lifecycle-common-java8")) {
                details.useVersion("2.6.1")
            }
        }
    }

    kotlinOptions {
        jvmTarget = versions.jvmTarget
    }

    compileOptions {
        sourceCompatibility versions.sourceCompatibility
        targetCompatibility versions.targetCompatibility
    }

    buildFeatures {
        compose true
        dataBinding true
        viewBinding true
    }

    composeOptions {
        kotlinCompilerExtensionVersion = versions.kotlinComposeCompilerExt
    }

    namespace 'com.grarcht.shuttle.demo.mvvmwithcompose'
}

dependencies {
    implementation jetbrainsKotlinDeps.stdlib
    implementation jetbrainsKotlinDeps.coroutines

    implementation androidXDeps.activityKtx
    implementation androidXDeps.annotationJvm
    implementation androidXDeps.appCompat
    implementation androidXDeps.compose.activity
    implementation androidXDeps.compose.foundation
    implementation androidXDeps.compose.foundationLayout
    implementation androidXDeps.compose.material
    implementation androidXDeps.compose.materialIcons
    implementation androidXDeps.compose.runtime
    implementation androidXDeps.compose.ui
    implementation androidXDeps.compose.uiTooling
    implementation androidXDeps.constraintLayout
    implementation androidXDeps.coreKtx
    implementation androidXDeps.lifecycle.extensions
    implementation androidXDeps.lifecycle.viewModel
    implementation androidXDeps.material

    api dependencyInjectionDeps.hilt
    implementation androidXDeps.coreKtx
    ksp dependencyInjectionDeps.hiltCompiler

    implementation project(':demos-core-lib')


    // To use a single aar file dependency, do something like the following.
    // If another integration extension is desired, a corresponding configuration should be
    // declared here for the "solution-builder" project.
    // implementation project(path: ':solution-builder', configuration: 'withRoom')

    // To use lighter weight, independent dependencies, comment out the above dependency and
    // uncomment the following:
     implementation project(':framework')
     implementation project(':framework-integrations-persistence')
     implementation project(':framework-integrations-extensions-room')
     implementation project(':framework-addons-navigation-component')

    // To use maven dependencies, use the following:
//    implementation shuttle.framework
//    implementation shuttle.integrationsExtensionsRoom
//    implementation shuttle.addOnsNavigationComponent

    androidTestImplementation testingDeps.junit.ext
    androidTestImplementation testingDeps.espresso.core
    androidTestRuntimeOnly testingDeps.junit.junit5AndroidTestRunner
    testImplementation testingDeps.junit.jupiterApi
    testRuntimeOnly testingDeps.junit.jupiterEngine
}